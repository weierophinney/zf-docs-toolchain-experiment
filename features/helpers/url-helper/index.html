<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">   
    <link rel="shortcut icon" href="../../../img/favicon.ico">

    <title>UrlHelper - Expressive</title>

    <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../../css/base.css" rel="stylesheet">
    <link href="../../../css/cinder.css" rel="stylesheet">
    <link href="../../../css/prism-zf.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../..">Expressive</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../getting-started/features/">Overview and Features</a>
</li>

                        
                            
<li >
    <a href="../../../getting-started/standalone/">Quick Start: Standalone</a>
</li>

                        
                            
<li >
    <a href="../../../getting-started/skeleton/">Quick Start: Skeleton Installer</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Features <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../application/">Applications</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Containers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../container/intro/">Introduction</a>
</li>

        
            
<li >
    <a href="../../container/factories/">Container Factories</a>
</li>

        
            
<li >
    <a href="../../container/zend-servicemanager/">Using zend-servicemanager</a>
</li>

        
            
<li >
    <a href="../../container/pimple/">Using Pimple</a>
</li>

        
            
<li >
    <a href="../../container/aura-di/">Using Aura.Di</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Routing Adapters</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../router/intro/">Introduction</a>
</li>

        
            
<li >
    <a href="../../router/interface/">Routing Interface</a>
</li>

        
            
<li >
    <a href="../../router/uri-generation/">URI Generation</a>
</li>

        
            
<li >
    <a href="../../router/result-observers/">Route Result Observers</a>
</li>

        
            
<li >
    <a href="../../router/piping/">Routing vs Piping</a>
</li>

        
            
<li >
    <a href="../../router/aura/">Using Aura</a>
</li>

        
            
<li >
    <a href="../../router/fast-route/">Using FastRoute</a>
</li>

        
            
<li >
    <a href="../../router/zf2/">Using the ZF2 Router</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Templating</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../template/intro/">Introduction</a>
</li>

        
            
<li >
    <a href="../../template/interface/">Template Renderer Interface</a>
</li>

        
            
<li >
    <a href="../../template/middleware/">Templated Middleware</a>
</li>

        
            
<li >
    <a href="../../template/plates/">Using Plates</a>
</li>

        
            
<li >
    <a href="../../template/twig/">Using Twig</a>
</li>

        
            
<li >
    <a href="../../template/zend-view/">Using zend-view</a>
</li>

        
    </ul>
  </li>

                        
                            
<li >
    <a href="../../error-handling/">Error Handling</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Helpers</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../intro/">Introduction</a>
</li>

        
            
<li class="active">
    <a href="./">UrlHelper</a>
</li>

        
            
<li >
    <a href="../server-url-helper/">ServerUrlHelper</a>
</li>

        
            
<li >
    <a href="../body-parse/">Body Parsing Middleware</a>
</li>

        
    </ul>
  </li>

                        
                            
<li >
    <a href="../../emitters/">Emitters</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cookbook <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../cookbook/common-prefix-for-routes/">Prepending a common path to all routes</a>
</li>

                        
                            
<li >
    <a href="../../../cookbook/route-specific-pipeline/">Route-specific middleware pipelines</a>
</li>

                        
                            
<li >
    <a href="../../../cookbook/custom-404-page-handling/">Setting custom 404 page handling</a>
</li>

                        
                            
<li >
    <a href="../../../cookbook/using-custom-view-helpers/">Registering custom view helpers when using zend-view</a>
</li>

                        
                            
<li >
    <a href="../../../cookbook/using-zend-form-view-helpers/">Using zend-form view helpers</a>
</li>

                        
                            
<li >
    <a href="../../../cookbook/using-a-base-path/">Using Expressive from a subdirectory</a>
</li>

                        
                            
<li >
    <a href="../../../cookbook/modular-layout/">Building modular applications</a>
</li>

                        
                            
<li >
    <a href="../../../cookbook/setting-locale-depending-routing-parameter/">Setting a locale based on a routing parameter</a>
</li>

                        
                            
<li >
    <a href="../../../cookbook/setting-locale-without-routing-parameter/">Setting a locale without a routing parameter</a>
</li>

                        
                            
<li >
    <a href="../../../cookbook/debug-toolbars/">Enabling debug toolbars</a>
</li>

                        
                            
<li >
    <a href="../../../cookbook/using-routed-middleware-class-as-controller/">Handling multiple routes in a single class</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../reference/usage-examples/">Examples</a>
</li>

                        
                            
<li >
    <a href="../../../reference/expressive-projects/">Expressive Projects</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Migration</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../reference/migration/rc-to-v1/">From RC5 and Earlier</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../intro/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../server-url-helper/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/zendframework/zend-expressive">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#urlhelper">UrlHelper</a></li>
        
            <li><a href="#usage">Usage</a></li>
        
            <li><a href="#creating-an-instance">Creating an instance</a></li>
        
            <li><a href="#using-the-helper-in-middleware">Using the helper in middleware</a></li>
        
            <li><a href="#base-path-support">Base Path support</a></li>
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="urlhelper">UrlHelper</h1>
<p><code>Zend\Expressive\Helper\UrlHelper</code> provides the ability to generate a URI path
based on a given route defined in the <code>Zend\Expressive\Router\RouterInterface</code>.
If injected with a route result, and the route being used was also the one
matched during routing, you can provide a subset of routing parameters, and any
not provided will be pulled from those matched.</p>
<h2 id="usage">Usage</h2>
<p>When you have an instance, use either its <code>generate()</code> method, or call the
instance as an invokable:</p>
<pre class="codehilite"><code class="language-php">// Using the generate() method:
$url = $helper-&gt;generate('resource', ['id' =&gt; 'sha1']);

// is equivalent to invocation:
$url = $helper('resource', ['id' =&gt; 'sha1']);</code></pre>


<p>The signature for both is:</p>
<pre class="codehilite"><code class="language-php">function ($routeName, array $params = []) : string</code></pre>


<p>Where:</p>
<ul>
<li><code>$routeName</code> is the name of a route defined in the composed router. You may
  omit this argument if you want to generate the path for the currently matched
  request.</li>
<li><code>$params</code> is an array of substitutions to use for the provided route, with the
  following behavior:</li>
<li>If a <code>RouteResult</code> is composed in the helper, and the <code>$routeName</code> matches
    it, the provided <code>$params</code> will be merged with any matched parameters, with
    those provided taking precedence.</li>
<li>If a <code>RouteResult</code> is not composed, or if the composed result does not match
    the provided <code>$routeName</code>, then only the <code>$params</code> provided will be used 
    for substitutions.</li>
<li>If no <code>$params</code> are provided, and the <code>$routeName</code> matches the currently
    matched route, then any matched parameters found will be used.
    parameters found will be used.</li>
<li>If no <code>$params</code> are provided, and the <code>$routeName</code> does not match the
    currently matched route, or if no route result is present, then no
    substitutions will be made.</li>
</ul>
<p>Each method will raise an exception if:</p>
<ul>
<li>No <code>$routeName</code> is provided, and no <code>RouteResult</code> is composed.</li>
<li>No <code>$routeName</code> is provided, a <code>RouteResult</code> is composed, but that result
  represents a matching failure.</li>
<li>The given <code>$routeName</code> is not defined in the router.</li>
</ul>
<h2 id="creating-an-instance">Creating an instance</h2>
<p>In order to use the helper, you will need to instantiate it with the current
<code>RouterInterface</code>. The factory <code>Zend\Expressive\Helper\UrlHelperFactory</code> has
been provided for this purpose, and can be used trivially with most
dependency injection containers implementing container-interop. Additionally,
it is most useful when injected with the current results of routing, which
requires registering middleware with the application that can inject the route
result. The following steps should be followed to register and configure the helper:</p>
<ul>
<li>Register the <code>UrlHelper</code> as a service in your container, using the provided
  factory.</li>
<li>Register the <code>UrlHelperMiddleware</code> as a service in your container, using the
  provided factory.</li>
<li>Register the <code>UrlHelperMiddleware</code> as pipeline middleware, immediately
  following the routing middleware.</li>
</ul>
<h3 id="registering-the-helper-service">Registering the helper service</h3>
<p>The following examples demonstrate programmatic registration of the <code>UrlHelper</code>
service in your selected dependency injection container.</p>
<pre class="codehilite"><code class="language-php">use Zend\Expressive\Helper\UrlHelper;
use Zend\Expressive\Helper\UrlHelperFactory;

// zend-servicemanager:
$services-&gt;setFactory(UrlHelper::class, UrlHelperFactory::class);

// Pimple:
$pimple[UrlHelper::class] = function ($container) {
    $factory = new UrlHelperFactory();
    return $factory($container);
};

// Aura.Di:
$container-&gt;set(UrlHelperFactory::class, $container-&gt;lazyNew(UrlHelperFactory::class));
$container-&gt;set(
    UrlHelper::class,
    $container-&gt;lazyGetCall(UrlHelperFactory::class, '__invoke', $container)
);</code></pre>


<p>The following dependency configuration will work for all three when using the
Expressive skeleton:</p>
<pre class="codehilite"><code class="language-php">return ['dependencies' =&gt; [
    'factories' =&gt; [
        UrlHelper::class =&gt; UrlHelperFactory::class,
    ],
]]</code></pre>


<blockquote>
<h4 id="urlhelperfactory-requires-routerinterface">UrlHelperFactory requires RouterInterface</h4>
<p>The factory requires that a service named <code>Zend\Expressive\Router\RouterInterface</code> is present,
and will raise an exception if the service is not found.</p>
</blockquote>
<h3 id="registering-the-pipeline-middleware">Registering the pipeline middleware</h3>
<p>To register the <code>UrlHelperMiddleware</code> as pipeline middleware following the
routing middleware:</p>
<pre class="codehilite"><code class="language-php">use Zend\Expressive\Helper\UrlHelperMiddleware;

// Programmatically:
$app-&gt;pipeRoutingMiddleware();
$app-&gt;pipe(UrlHelperMiddleware::class);
$app-&gt;pipeDispatchMiddleware();

// Or use configuration:
// [
//     'middleware_pipeline' =&gt; [
//         /* ... */
//         Zend\Expressive\Container\ApplicationFactory::ROUTING_MIDDLEWARE,
//         ['middleware' =&gt; UrlHelperMiddleware::class],
//         Zend\Expressive\Container\ApplicationFactory::DISPATCH_MIDDLEWARE,
//         /* ... */
//     ],
// ]
//
// Alternately, create a nested middleware pipeline for the routing, UrlHelper,
// and dispatch middleware:
// [
//     'middleware_pipeline' =&gt; [
//         /* ... */
//         'routing' =&gt; [
//             'middleware' =&gt; [
//                 Zend\Expressive\Container\ApplicationFactory::ROUTING_MIDDLEWARE,
//                 UrlHelperMiddleware::class
//                 Zend\Expressive\Container\ApplicationFactory::DISPATCH_MIDDLEWARE,
//             ],
//             'priority' =&gt; 1,
//         ],
//         /* ... */
//     ],
// ]</code></pre>


<p>The following dependency configuration will work for all three when using the
Expressive skeleton:</p>
<pre class="codehilite"><code class="language-php">return [
    'dependencies' =&gt; [
        'factories' =&gt; [
            UrlHelper::class =&gt; UrlHelperFactory::class,
            UrlHelperMiddleware::class =&gt; UrlHelperMiddlewareFactory::class,
        ],
    ],
    'middleware_pipeline' =&gt; [
        Zend\Expressive\Container\ApplicationFactory::ROUTING_MIDDLEWARE,
        ['middleware' =&gt; UrlHelperMiddleware::class],
        Zend\Expressive\Container\ApplicationFactory::DISPATCH_MIDDLEWARE,
    ],
];

// OR:
return [
    'dependencies' =&gt; [
        'factories' =&gt; [
            UrlHelper::class =&gt; UrlHelperFactory::class,
            UrlHelperMiddleware::class =&gt; UrlHelperMiddlewareFactory::class,
        ],
    ],
    'middleware_pipeline' =&gt; [
        'routing' =&gt; [
            'middleware' =&gt; [
                Zend\Expressive\Container\ApplicationFactory::ROUTING_MIDDLEWARE,
                UrlHelperMiddleware::class,
                Zend\Expressive\Container\ApplicationFactory::DISPATCH_MIDDLEWARE,
            ],
            'priority' =&gt; 1,
        ],
    ],
];</code></pre>


<blockquote>
<h4 id="skeleton-configures-helpers">Skeleton configures helpers</h4>
<p>If you started your project using the Expressive skeleton package, the
<code>UrlHelper</code> and <code>UrlHelperMiddleware</code> factories are already registered for
you, as is the <code>UrlHelperMiddleware</code> pipeline middleware.</p>
</blockquote>
<h2 id="using-the-helper-in-middleware">Using the helper in middleware</h2>
<p>Compose the helper in your middleware (or elsewhere), and then use it to
generate URI paths:</p>
<pre class="codehilite"><code class="language-php">use Zend\Expressive\Helper\UrlHelper;

class FooMiddleware
{
    private $helper;

    public function __construct(UrlHelper $helper)
    {
        $this-&gt;helper = $helper;
    }

    public function __invoke($request, $response, callable $next)
    {
        $response = $response-&gt;withHeader(
            'Link',
            $this-&gt;helper-&gt;generate('resource', ['id' =&gt; 'sha1'])
        );
        return $next($request, $response);
    }
}</code></pre>


<h2 id="base-path-support">Base Path support</h2>
<p>If your application is running under a subdirectory, or if you are running
pipeline middleware that is intercepting on a subpath, the paths generated
by the router may not reflect the <em>base path</em>, and thus be invalid. To
accommodate this, the <code>UrlHelper</code> supports injection of the base path; when
present, it will be prepended to the path generated by the router.</p>
<p>As an example, perhaps you have middleware running to intercept a language
prefix in the URL; this middleware could then inject the <code>UrlHelper</code> with the
detected language, before stripping it off the request URI instance to pass on
to the router:</p>
<pre class="codehilite"><code class="language-php">use Locale;
use Zend\Expressive\Helper\UrlHelper;

class LocaleMiddleware
{
    private $helper;

    public function __construct(UrlHelper $helper)
    {
        $this-&gt;helper = $helper;
    }

    public function __invoke($request, $response, $next)
    {
        $uri = $request-&gt;getUri();
        $path = $uri-&gt;getPath();
        if (! preg_match('#^/(?P&lt;lang&gt;[a-z]{2})/#', $path, $matches)) {
            return $next($request, $response);
        }

        $lang = $matches['lang'];
        Locale::setDefault($lang);
        $this-&gt;helper-&gt;setBasePath($lang);

        return $next(
            $request-&gt;withUri(
                $uri-&gt;withPath(substr($path, 3))
            ),
            $response
        );
    }
}</code></pre>


<p>(Note: if the base path injected is not prefixed with <code>/</code>, the helper will add
the slash.)</p>
<p>Paths generated by the <code>UriHelper</code> from this point forward will have the
detected language prefix.</p></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Copyright (c) 2016 <a href="http://www.zend.com/">Zend Technologies USA Inc.</a><br></small>
        </p>
        <p><small><a href="http://framework.zend.com">Learn more about Zend Framework</a></small></p>
    </footer>

    <script src="../../../js/jquery-1.10.2.min.js"></script>
    <script src="../../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../../js/prism-zf.js"></script>

    <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>
    <script src="../../../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
